<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tempahan Bilik ICT</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>
  <!-- Banner (editable by admin) -->
  <section id="banner" class="bg-primary text-white text-center p-5 position-relative">
  <h1>Tempahan Bilik ICT</h1>
  <p id="banner-text">Selamat datang ke sistem tempahan bilik ICT kami!</p>
  
  <!-- Butang kecil di penjuru kanan atas -->
  <a href="senarai.html" class="btn btn-light btn-sm position-absolute top-0 end-0 m-3">
    📋 Lihat Tempahan
  </a>
</section>

  
  <!-- Booking Form -->
  <div class="container my-5">
    <h2>Tempah Bilik ICT</h2>
    <form id="booking-form">
      <div class="mb-3">
        <label for="name" class="form-label">Nama</label>
        <input type="text" class="form-control" id="name" required />
      </div>
      
      <div class="mb-3">
        <label for="class" class="form-label">Kelas</label>
        <input type="text" class="form-control" id="class" required />
      </div>
      
      <div class="mb-3">
        <label for="date" class="form-label">Tarikh</label>
        <input type="date" class="form-control" id="date" required />
      </div>
      
      <div class="mb-3">
        <label class="form-label">Waktu</label><br />
        <div class="row">
          <div class="col-md-6">
            <label for="start-time" class="form-label">Mula</label>
            <select class="form-control" id="start-time" required>
              <option value="">Pilih masa mula</option>
              <option value="08:00">08:00 AM</option>
              <option value="08:30">08:30 AM</option>
              <option value="09:00">09:00 AM</option>
              <option value="09:30">09:30 AM</option>
              <option value="10:00">10:00 AM</option>
              <option value="10:30">10:30 AM</option>
              <option value="11:00">11:00 AM</option>
              <option value="11:30">11:30 AM</option>
              <option value="12:00">12:00 PM</option>
              <option value="12:30">12:30 PM</option>
              <option value="13:00">01:00 PM</option>
              <option value="13:30">01:30 PM</option>
              <option value="14:00">02:00 PM</option>
              <option value="14:30">02:30 PM</option>
              <option value="15:00">03:00 PM</option>
              <option value="15:30">03:30 PM</option>
              <option value="16:00">04:00 PM</option>
              <option value="16:30">04:30 PM</option>
              <option value="17:00">05:00 PM</option>
            </select>
          </div>
          
          <div class="col-md-6">
            <label for="end-time" class="form-label"> Tamat</label>
            <select class="form-control" id="end-time" required>
              <option value="">Pilih masa tamat</option>
              <option value="08:30">08:30 AM</option>
              <option value="09:00">09:00 AM</option>
              <option value="09:30">09:30 AM</option>
              <option value="10:00">10:00 AM</option>
              <option value="10:30">10:30 AM</option>
              <option value="11:00">11:00 AM</option>
              <option value="11:30">11:30 AM</option>
              <option value="12:00">12:00 PM</option>
              <option value="12:30">12:30 PM</option>
              <option value="13:00">01:00 PM</option>
              <option value="13:30">01:30 PM</option>
              <option value="14:00">02:00 PM</option>
              <option value="14:30">02:30 PM</option>
              <option value="15:00">03:00 PM</option>
              <option value="15:30">03:30 PM</option>
              <option value="16:00">04:00 PM</option>
              <option value="16:30">04:30 PM</option>
              <option value="17:00">05:00 PM</option>
              <option value="17:30">05:30 PM</option>
            </select>
          </div>
        </div>
        <small class="form-text text-muted">Masa tamat mesti selepas masa mula</small>
      </div>
      
      <div class="mb-3">
        <label for="purpose" class="form-label">Tujuan Penggunaan</label>
        <textarea class="form-control" id="purpose" rows="3" placeholder="Terangkan tujuan penggunaan bilik ICT"></textarea>
      </div>
      
      <button type="submit" class="btn btn-primary">Hantar Tempahan</button>
    </form>
  </div>

  <script>
    // Handle form submission
    document.getElementById('booking-form').addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Get form values
      const name = document.getElementById('name').value;
      const className = document.getElementById('class').value;
      const date = document.getElementById('date').value;
      const startTime = document.getElementById('start-time').value;
      const endTime = document.getElementById('end-time').value;
      const purpose = document.getElementById('purpose').value;
      
      // Validate time selection
      if (startTime >= endTime) {
        alert('Masa tamat mesti selepas masa mula!');
        return;
      }
      
      // Create booking summary
      const bookingDetails = `
        Nama: ${name}
        Kelas: ${className}
        Tarikh: ${date}
        Masa: ${startTime} - ${endTime}
        Tujuan: ${purpose || 'Tidak dinyatakan'}
      `;

      // Save to localStorage
const newBooking = { name, class: className, date, startTime, endTime, purpose };
const existingBookings = JSON.parse(localStorage.getItem("bookings")) || [];
existingBookings.push(newBooking);
localStorage.setItem("bookings", JSON.stringify(existingBookings));

// Save tempahan semasa (untuk edit nanti)
localStorage.setItem("currentBooking", JSON.stringify(newBooking));

      
      alert('Tempahan anda telah dihantar!\n\n' + bookingDetails);
      
      // Here you can add AJAX to submit data to backend
      // Example:
      // fetch('/submit-booking', {
      //   method: 'POST',
      //   headers: { 'Content-Type': 'application/json' },
      //   body: JSON.stringify({
      //     name, class: className, date, startTime, endTime, purpose
      //   })
      // });
    });

    // Set minimum date to today
    document.getElementById('date').min = new Date().toISOString().split('T')[0];
    
    // Auto-update end time options based on start time selection
    document.getElementById('start-time').addEventListener('change', function() {
      const startTime = this.value;
      const endTimeSelect = document.getElementById('end-time');
      const startOptions = Array.from(this.options);
      const startIndex = startOptions.findIndex(option => option.value === startTime);
      
      // Clear end time selection
      endTimeSelect.value = '';
      
      // Enable only time slots after the selected start time
      Array.from(endTimeSelect.options).forEach((option, index) => {
        if (index === 0) return; // Skip the placeholder option
        
        const endIndex = startOptions.findIndex(startOption => startOption.value === option.value);
        option.disabled = endIndex <= startIndex;
      });
    });
  </script>

  <script>
  // Simulasi waktu yang telah ditempah
  const bookedSlots = [
    { date: "2025-07-01", start: "08:30", end: "10:00" },
    { date: "2025-07-01", start: "14:00", end: "15:30" }
  ];

  function cleanOptions(selectElement) {
    Array.from(selectElement.options).forEach(option => {
      option.disabled = false;
      option.text = option.text.replace(/^❌\s/, '').replace(/\s\(Ditempah\)$/, '');
    });
  }

  function disableBookedSlots() {
    const selectedDate = document.getElementById("date").value;
    const startTimeSelect = document.getElementById("start-time");
    const endTimeSelect = document.getElementById("end-time");

    // Bersihkan teks dan enable semua option dahulu
    cleanOptions(startTimeSelect);
    cleanOptions(endTimeSelect);

    const bookedForDate = bookedSlots.filter(slot => slot.date === selectedDate);

    bookedForDate.forEach(slot => {
      Array.from(startTimeSelect.options).forEach(option => {
        if (option.value >= slot.start && option.value < slot.end) {
          option.disabled = true;
          option.text = `❌ ${option.text} (Ditempah)`;
        }
      });

      Array.from(endTimeSelect.options).forEach(option => {
        if (option.value > slot.start && option.value <= slot.end) {
          option.disabled = true;
          option.text = `❌ ${option.text} (Ditempah)`;
        }
      });
    });
  }

  document.getElementById("date").addEventListener("change", function () {
    disableBookedSlots();
  });
</script>


</body>
</html>